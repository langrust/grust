---
source: tests/typing.rs
expression: file
---
typedefs:
  - Structure:
      id: GainPID
      fields:
        - - k_p
          - Float
        - - k_i
          - Float
        - - k_d
          - Float
      location: ~
functions:
  - id: min
    inputs:
      - - a
        - Float
      - - b
        - Float
    statements:
      - id: test
        element_type: Boolean
        expression:
          Application:
            function_expression:
              Identifier:
                id: " > "
                typing:
                  Abstract:
                    - - Float
                      - Float
                    - Boolean
                location: ~
            inputs:
              - Identifier:
                  id: a
                  typing: Float
                  location: ~
              - Identifier:
                  id: b
                  typing: Float
                  location: ~
            typing: Boolean
            location: ~
        location: ~
      - id: result
        element_type: Float
        expression:
          Application:
            function_expression:
              Identifier:
                id: if_then_else
                typing:
                  Abstract:
                    - - Boolean
                      - Float
                      - Float
                    - Float
                location: ~
            inputs:
              - Identifier:
                  id: test
                  typing: Boolean
                  location: ~
              - Identifier:
                  id: b
                  typing: Float
                  location: ~
              - Identifier:
                  id: a
                  typing: Float
                  location: ~
            typing: Float
            location: ~
        location: ~
    returned:
      - Float
      - Identifier:
          id: result
          typing: Float
          location: ~
    location: ~
nodes:
  - id: integrate
    is_component: false
    inputs:
      - - x
        - Float
      - - dt
        - Float
    equations:
      - - prev_i
        - scope: Local
          id: prev_i
          signal_type: Float
          expression:
            FollowedBy:
              constant:
                Float: 0
              expression:
                SignalCall:
                  id: i
                  typing: Float
                  location: ~
              typing: Float
              location: ~
          location: ~
      - - i
        - scope: Output
          id: i
          signal_type: Float
          expression:
            FunctionApplication:
              function_expression:
                Identifier:
                  id: min
                  typing:
                    Abstract:
                      - - Float
                        - Float
                      - Float
                  location: ~
              inputs:
                - FunctionApplication:
                    function_expression:
                      Identifier:
                        id: " + "
                        typing:
                          Abstract:
                            - - Float
                              - Float
                            - Float
                        location: ~
                    inputs:
                      - SignalCall:
                          id: prev_i
                          typing: Float
                          location: ~
                      - FunctionApplication:
                          function_expression:
                            Identifier:
                              id: " * "
                              typing:
                                Abstract:
                                  - - Float
                                    - Float
                                  - Float
                              location: ~
                          inputs:
                            - SignalCall:
                                id: x
                                typing: Float
                                location: ~
                            - SignalCall:
                                id: dt
                                typing: Float
                                location: ~
                          typing: Float
                          location: ~
                    typing: Float
                    location: ~
                - SignalCall:
                    id: MAX_INTEGRALE
                    typing: Float
                    location: ~
              typing: Float
              location: ~
          location: ~
      - - MAX_INTEGRALE
        - scope: Local
          id: MAX_INTEGRALE
          signal_type: Float
          expression:
            Constant:
              constant:
                Float: 1000
              typing: Float
              location: ~
          location: ~
    contract:
      requires: []
      ensures: []
      invariant: []
      assert: []
    location: ~
  - id: derive
    is_component: false
    inputs:
      - - x
        - Float
      - - dt
        - Float
    equations:
      - - d
        - scope: Output
          id: d
          signal_type: Float
          expression:
            FunctionApplication:
              function_expression:
                Identifier:
                  id: " / "
                  typing:
                    Abstract:
                      - - Float
                        - Float
                      - Float
                  location: ~
              inputs:
                - FunctionApplication:
                    function_expression:
                      Identifier:
                        id: (_)
                        typing:
                          Abstract:
                            - - Float
                            - Float
                        location: ~
                    inputs:
                      - FunctionApplication:
                          function_expression:
                            Identifier:
                              id: " - "
                              typing:
                                Abstract:
                                  - - Float
                                    - Float
                                  - Float
                              location: ~
                          inputs:
                            - SignalCall:
                                id: x
                                typing: Float
                                location: ~
                            - SignalCall:
                                id: prev_x
                                typing: Float
                                location: ~
                          typing: Float
                          location: ~
                    typing: Float
                    location: ~
                - SignalCall:
                    id: dt
                    typing: Float
                    location: ~
              typing: Float
              location: ~
          location: ~
      - - prev_x
        - scope: Local
          id: prev_x
          signal_type: Float
          expression:
            FollowedBy:
              constant:
                Float: 0
              expression:
                SignalCall:
                  id: x
                  typing: Float
                  location: ~
              typing: Float
              location: ~
          location: ~
    contract:
      requires: []
      ensures: []
      invariant: []
      assert: []
    location: ~
component:
  id: pid
  is_component: true
  inputs:
    - - v_c
      - Float
    - - v
      - Float
    - - dt
      - Float
  equations:
    - - gain
      - scope: Local
        id: gain
        signal_type:
          Structure: GainPID
        expression:
          Structure:
            name: GainPID
            fields:
              - - k_p
                - Constant:
                    constant:
                      Float: 0.2
                    typing: Float
                    location: ~
              - - k_i
                - Constant:
                    constant:
                      Float: 1.5
                    typing: Float
                    location: ~
              - - k_d
                - Constant:
                    constant:
                      Float: 6
                    typing: Float
                    location: ~
            typing:
              Structure: GainPID
            location: ~
        location: ~
    - - u
      - scope: Output
        id: u
        signal_type: Float
        expression:
          Match:
            expression:
              SignalCall:
                id: gain
                typing:
                  Structure: GainPID
                location: ~
            arms:
              - - Structure:
                    name: GainPID
                    fields:
                      - - k_p
                        - Identifier:
                            name: k_p
                            location: ~
                      - - k_i
                        - Identifier:
                            name: k_i
                            location: ~
                      - - k_d
                        - Identifier:
                            name: k_d
                            location: ~
                    location: ~
                - ~
                - FunctionApplication:
                    function_expression:
                      Identifier:
                        id: " + "
                        typing:
                          Abstract:
                            - - Float
                              - Float
                            - Float
                        location: ~
                    inputs:
                      - FunctionApplication:
                          function_expression:
                            Identifier:
                              id: " + "
                              typing:
                                Abstract:
                                  - - Float
                                    - Float
                                  - Float
                              location: ~
                          inputs:
                            - FunctionApplication:
                                function_expression:
                                  Identifier:
                                    id: " * "
                                    typing:
                                      Abstract:
                                        - - Float
                                          - Float
                                        - Float
                                    location: ~
                                inputs:
                                  - SignalCall:
                                      id: k_p
                                      typing: Float
                                      location: ~
                                  - SignalCall:
                                      id: e
                                      typing: Float
                                      location: ~
                                typing: Float
                                location: ~
                            - FunctionApplication:
                                function_expression:
                                  Identifier:
                                    id: " * "
                                    typing:
                                      Abstract:
                                        - - Float
                                          - Float
                                        - Float
                                    location: ~
                                inputs:
                                  - SignalCall:
                                      id: k_i
                                      typing: Float
                                      location: ~
                                  - SignalCall:
                                      id: e_i
                                      typing: Float
                                      location: ~
                                typing: Float
                                location: ~
                          typing: Float
                          location: ~
                      - FunctionApplication:
                          function_expression:
                            Identifier:
                              id: " * "
                              typing:
                                Abstract:
                                  - - Float
                                    - Float
                                  - Float
                              location: ~
                          inputs:
                            - SignalCall:
                                id: k_d
                                typing: Float
                                location: ~
                            - SignalCall:
                                id: e_d
                                typing: Float
                                location: ~
                          typing: Float
                          location: ~
                    typing: Float
                    location: ~
            typing: Float
            location: ~
        location: ~
    - - e
      - scope: Local
        id: e
        signal_type: Float
        expression:
          FunctionApplication:
            function_expression:
              Identifier:
                id: " - "
                typing:
                  Abstract:
                    - - Float
                      - Float
                    - Float
                location: ~
            inputs:
              - SignalCall:
                  id: v_c
                  typing: Float
                  location: ~
              - SignalCall:
                  id: v
                  typing: Float
                  location: ~
            typing: Float
            location: ~
        location: ~
    - - e_i
      - scope: Local
        id: e_i
        signal_type: Float
        expression:
          NodeApplication:
            node: integrate
            inputs:
              - SignalCall:
                  id: e
                  typing: Float
                  location: ~
              - SignalCall:
                  id: dt
                  typing: Float
                  location: ~
            signal: i
            typing: Float
            location: ~
        location: ~
    - - e_d
      - scope: Local
        id: e_d
        signal_type: Float
        expression:
          NodeApplication:
            node: derive
            inputs:
              - SignalCall:
                  id: e
                  typing: Float
                  location: ~
              - SignalCall:
                  id: dt
                  typing: Float
                  location: ~
            signal: d
            typing: Float
            location: ~
        location: ~
  contract:
    requires: []
    ensures: []
    invariant: []
    assert: []
  location: ~
location: ~

