---
source: tests/hir_from_ast.rs
expression: file
---
typedefs:
  - Structure:
      id: GainPID
      fields:
        - - k_p
          - Float
        - - k_i
          - Float
        - - k_d
          - Float
      location: ~
functions:
  - id: min
    inputs:
      - - a
        - Float
      - - b
        - Float
    statements:
      - id: test
        element_type: Boolean
        expression:
          Application:
            function_expression:
              Call:
                id: " > "
                typing:
                  Abstract:
                    - - Float
                      - Float
                    - Boolean
                location: ~
            inputs:
              - Call:
                  id: a
                  typing: Float
                  location: ~
              - Call:
                  id: b
                  typing: Float
                  location: ~
            typing: Boolean
            location: ~
        location: ~
      - id: result
        element_type: Float
        expression:
          Application:
            function_expression:
              Call:
                id: if_then_else
                typing:
                  Abstract:
                    - - Boolean
                      - Float
                      - Float
                    - Float
                location: ~
            inputs:
              - Call:
                  id: test
                  typing: Boolean
                  location: ~
              - Call:
                  id: b
                  typing: Float
                  location: ~
              - Call:
                  id: a
                  typing: Float
                  location: ~
            typing: Float
            location: ~
        location: ~
    returned:
      - Float
      - Call:
          id: result
          typing: Float
          location: ~
    location: ~
nodes:
  - id: integrate
    is_component: false
    inputs:
      - - x
        - Float
      - - dt
        - Float
    unscheduled_equations:
      MAX_INTEGRALE:
        scope: Local
        id: MAX_INTEGRALE
        signal_type: Float
        expression:
          Constant:
            constant:
              Float: 1000
            typing: Float
            location: ~
            dependencies: ~
        location: ~
      i:
        scope: Output
        id: i
        signal_type: Float
        expression:
          FunctionApplication:
            function_expression:
              Call:
                id: min
                typing:
                  Abstract:
                    - - Float
                      - Float
                    - Float
                location: ~
            inputs:
              - FunctionApplication:
                  function_expression:
                    Call:
                      id: " + "
                      typing:
                        Abstract:
                          - - Float
                            - Float
                          - Float
                      location: ~
                  inputs:
                    - SignalCall:
                        signal:
                          id: prev_i
                          scope: Local
                        typing: Float
                        location: ~
                        dependencies: ~
                    - FunctionApplication:
                        function_expression:
                          Call:
                            id: " * "
                            typing:
                              Abstract:
                                - - Float
                                  - Float
                                - Float
                            location: ~
                        inputs:
                          - SignalCall:
                              signal:
                                id: x
                                scope: Input
                              typing: Float
                              location: ~
                              dependencies: ~
                          - SignalCall:
                              signal:
                                id: dt
                                scope: Input
                              typing: Float
                              location: ~
                              dependencies: ~
                        typing: Float
                        location: ~
                        dependencies: ~
                  typing: Float
                  location: ~
                  dependencies: ~
              - SignalCall:
                  signal:
                    id: MAX_INTEGRALE
                    scope: Local
                  typing: Float
                  location: ~
                  dependencies: ~
            typing: Float
            location: ~
            dependencies: ~
        location: ~
      prev_i:
        scope: Local
        id: prev_i
        signal_type: Float
        expression:
          FollowedBy:
            constant:
              Float: 0
            expression:
              SignalCall:
                signal:
                  id: i
                  scope: Output
                typing: Float
                location: ~
                dependencies: ~
            typing: Float
            location: ~
            dependencies: ~
        location: ~
    unitary_nodes: {}
    location: ~
    graph: ~
  - id: derive
    is_component: false
    inputs:
      - - x
        - Float
      - - dt
        - Float
    unscheduled_equations:
      d:
        scope: Output
        id: d
        signal_type: Float
        expression:
          FunctionApplication:
            function_expression:
              Call:
                id: " / "
                typing:
                  Abstract:
                    - - Float
                      - Float
                    - Float
                location: ~
            inputs:
              - FunctionApplication:
                  function_expression:
                    Call:
                      id: (_)
                      typing:
                        Abstract:
                          - - Float
                          - Float
                      location: ~
                  inputs:
                    - FunctionApplication:
                        function_expression:
                          Call:
                            id: " - "
                            typing:
                              Abstract:
                                - - Float
                                  - Float
                                - Float
                            location: ~
                        inputs:
                          - SignalCall:
                              signal:
                                id: x
                                scope: Input
                              typing: Float
                              location: ~
                              dependencies: ~
                          - SignalCall:
                              signal:
                                id: prev_x
                                scope: Local
                              typing: Float
                              location: ~
                              dependencies: ~
                        typing: Float
                        location: ~
                        dependencies: ~
                  typing: Float
                  location: ~
                  dependencies: ~
              - SignalCall:
                  signal:
                    id: dt
                    scope: Input
                  typing: Float
                  location: ~
                  dependencies: ~
            typing: Float
            location: ~
            dependencies: ~
        location: ~
      prev_x:
        scope: Local
        id: prev_x
        signal_type: Float
        expression:
          FollowedBy:
            constant:
              Float: 0
            expression:
              SignalCall:
                signal:
                  id: x
                  scope: Input
                typing: Float
                location: ~
                dependencies: ~
            typing: Float
            location: ~
            dependencies: ~
        location: ~
    unitary_nodes: {}
    location: ~
    graph: ~
component:
  id: pid
  is_component: true
  inputs:
    - - v_c
      - Float
    - - v
      - Float
    - - dt
      - Float
  unscheduled_equations:
    e:
      scope: Local
      id: e
      signal_type: Float
      expression:
        FunctionApplication:
          function_expression:
            Call:
              id: " - "
              typing:
                Abstract:
                  - - Float
                    - Float
                  - Float
              location: ~
          inputs:
            - SignalCall:
                signal:
                  id: v_c
                  scope: Input
                typing: Float
                location: ~
                dependencies: ~
            - SignalCall:
                signal:
                  id: v
                  scope: Input
                typing: Float
                location: ~
                dependencies: ~
          typing: Float
          location: ~
          dependencies: ~
      location: ~
    e_d:
      scope: Local
      id: e_d
      signal_type: Float
      expression:
        NodeApplication:
          node: derive
          inputs:
            - SignalCall:
                signal:
                  id: e
                  scope: Local
                typing: Float
                location: ~
                dependencies: ~
            - SignalCall:
                signal:
                  id: dt
                  scope: Input
                typing: Float
                location: ~
                dependencies: ~
          signal: d
          typing: Float
          location: ~
          dependencies: ~
      location: ~
    e_i:
      scope: Local
      id: e_i
      signal_type: Float
      expression:
        NodeApplication:
          node: integrate
          inputs:
            - SignalCall:
                signal:
                  id: e
                  scope: Local
                typing: Float
                location: ~
                dependencies: ~
            - SignalCall:
                signal:
                  id: dt
                  scope: Input
                typing: Float
                location: ~
                dependencies: ~
          signal: i
          typing: Float
          location: ~
          dependencies: ~
      location: ~
    gain:
      scope: Local
      id: gain
      signal_type:
        Structure: GainPID
      expression:
        Structure:
          name: GainPID
          fields:
            - - k_p
              - Constant:
                  constant:
                    Float: 0.2
                  typing: Float
                  location: ~
                  dependencies: ~
            - - k_i
              - Constant:
                  constant:
                    Float: 1.5
                  typing: Float
                  location: ~
                  dependencies: ~
            - - k_d
              - Constant:
                  constant:
                    Float: 6
                  typing: Float
                  location: ~
                  dependencies: ~
          typing:
            Structure: GainPID
          location: ~
          dependencies: ~
      location: ~
    u:
      scope: Output
      id: u
      signal_type: Float
      expression:
        Match:
          expression:
            SignalCall:
              signal:
                id: gain
                scope: Local
              typing:
                Structure: GainPID
              location: ~
              dependencies: ~
          arms:
            - - Structure:
                  name: GainPID
                  fields:
                    - - k_p
                      - Identifier:
                          name: k_p
                          location: ~
                    - - k_i
                      - Identifier:
                          name: k_i
                          location: ~
                    - - k_d
                      - Identifier:
                          name: k_d
                          location: ~
                  location: ~
              - ~
              - []
              - FunctionApplication:
                  function_expression:
                    Call:
                      id: " + "
                      typing:
                        Abstract:
                          - - Float
                            - Float
                          - Float
                      location: ~
                  inputs:
                    - FunctionApplication:
                        function_expression:
                          Call:
                            id: " + "
                            typing:
                              Abstract:
                                - - Float
                                  - Float
                                - Float
                            location: ~
                        inputs:
                          - FunctionApplication:
                              function_expression:
                                Call:
                                  id: " * "
                                  typing:
                                    Abstract:
                                      - - Float
                                        - Float
                                      - Float
                                  location: ~
                              inputs:
                                - SignalCall:
                                    signal:
                                      id: k_p
                                      scope: Local
                                    typing: Float
                                    location: ~
                                    dependencies: ~
                                - SignalCall:
                                    signal:
                                      id: e
                                      scope: Local
                                    typing: Float
                                    location: ~
                                    dependencies: ~
                              typing: Float
                              location: ~
                              dependencies: ~
                          - FunctionApplication:
                              function_expression:
                                Call:
                                  id: " * "
                                  typing:
                                    Abstract:
                                      - - Float
                                        - Float
                                      - Float
                                  location: ~
                              inputs:
                                - SignalCall:
                                    signal:
                                      id: k_i
                                      scope: Local
                                    typing: Float
                                    location: ~
                                    dependencies: ~
                                - SignalCall:
                                    signal:
                                      id: e_i
                                      scope: Local
                                    typing: Float
                                    location: ~
                                    dependencies: ~
                              typing: Float
                              location: ~
                              dependencies: ~
                        typing: Float
                        location: ~
                        dependencies: ~
                    - FunctionApplication:
                        function_expression:
                          Call:
                            id: " * "
                            typing:
                              Abstract:
                                - - Float
                                  - Float
                                - Float
                            location: ~
                        inputs:
                          - SignalCall:
                              signal:
                                id: k_d
                                scope: Local
                              typing: Float
                              location: ~
                              dependencies: ~
                          - SignalCall:
                              signal:
                                id: e_d
                                scope: Local
                              typing: Float
                              location: ~
                              dependencies: ~
                        typing: Float
                        location: ~
                        dependencies: ~
                  typing: Float
                  location: ~
                  dependencies: ~
          typing: Float
          location: ~
          dependencies: ~
      location: ~
  unitary_nodes: {}
  location: ~
  graph: ~
location: ~

